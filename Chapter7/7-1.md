### 花指令破解

话不多说，直接上题（BUUCTF）

![](https://pic1.imgdb.cn/item/67a5f8c5d0e0a243d4fc9a4d.jpg)

查壳发现 UPX

![](https://pic1.imgdb.cn/item/67a5f92bd0e0a243d4fc9a69.jpg)

万能工具脱壳

![](https://pic1.imgdb.cn/item/67a5f93fd0e0a243d4fc9a6d.jpg)

扔进 IDA32 中反编译发现报错，jnz 指令跳转到了下一行代码，即 call 指令，但是这个地址不存在，推测添加了花指令，导致 IDA 分析失败

![](https://pic1.imgdb.cn/item/67a5f964d0e0a243d4fc9a76.jpg)

花指令绕过就是把这一段改为 NOP 即可，鼠标光标停在 0x401020C 那，在编辑中修改字节

![](https://pic1.imgdb.cn/item/67a5f987d0e0a243d4fc9a7a.jpg)

C 到 F 为三个字节，修改为 90，0x90 代表指令 NOP

![](https://pic1.imgdb.cn/item/67a5f9a3d0e0a243d4fc9a7e.jpg)

修改后如下

![](https://pic1.imgdb.cn/item/67a5f9c9d0e0a243d4fc9a83.jpg)

同样的位置选择最后一个保存

![](https://pic1.imgdb.cn/item/67a5fa22d0e0a243d4fc9a96.png)

再重新打开就可以正常反编译 main 了，看到 case wsad 一眼迷宫题

![](https://pic1.imgdb.cn/item/67a5fddcd0e0a243d4fc9b30.jpg)

点进去就能拿到迷宫的字符串

![](https://pic1.imgdb.cn/item/67a5fdf5d0e0a243d4fc9b38.jpg)

编写脚本打印迷宫图，因为长度为 70，推测要么 7 * 10，要么 10 * 7

```python
def main():
    maze = "*******+********* ******    ****   ******* **F******    **************"
    print(len(maze))
    eid = maze.index("F")
    ex, ey = -4, 5
    c = (eid - ey) // (-ex)
    r = len(maze) // c
    for i in range(r):
        print(maze[c * i:c * (i + 1)])


if __name__ == "__main__":
    main()
```

