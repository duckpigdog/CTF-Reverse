### 字符读取长度破解

话不多说，直接上题（BUUCTF）

![](https://pic1.imgdb.cn/item/67c2a953d0e0a243d408c3e7.png)

先运行啥也没有

![](https://pic1.imgdb.cn/item/67c2a9ded0e0a243d408c41c.png)

扔 IDA 中解析看到有取地址 &unk_402008

![](https://pic1.imgdb.cn/item/67c2a99ad0e0a243d408c3ef.png)

查看其地址

![](https://pic1.imgdb.cn/item/67c2aa39d0e0a243d408c508.png)

放着大量字符，但是后面 28 应该是取的长度，查看其汇编代码

![](https://pic1.imgdb.cn/item/67c2ab59d0e0a243d408c535.png)

修改其值

![](https://pic1.imgdb.cn/item/67c2ab85d0e0a243d408c537.png)

保存

![](https://pic1.imgdb.cn/item/67c2ab97d0e0a243d408c539.png)

再次运行发现字符变少了，说明 v6 是一个读取字符串的函数

![](https://pic1.imgdb.cn/item/67c2ac05d0e0a243d408c5bb.png)

将其修改为实际长度 0xAF，保存运行拿到 flag

![](https://pic1.imgdb.cn/item/67c2ac81d0e0a243d408c68d.png)