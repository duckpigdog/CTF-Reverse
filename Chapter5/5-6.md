### Base64 换表破解

话不多说，直接上题（BUUCTF）

![](https://pic1.imgdb.cn/item/67b47166d0e0a243d4008948.png)

PE 检测没有壳

![](https://pic1.imgdb.cn/item/67b4737ad0e0a243d40089ae.png)

发现 Base64 编码

![](https://pic1.imgdb.cn/item/67b47402d0e0a243d40089cd.png)

正常解码是乱码，一定是换表了，去搜索字符串

![](https://pic1.imgdb.cn/item/67b47452d0e0a243d40089e4.png)

发现在函数列表中，有一个LookAtYou，原来是把密码表改了

![](https://pic1.imgdb.cn/item/67b474a0d0e0a243d40089fa.png)

先算出密码表

```c
#include<stdio.h>
#include<stdlib.h>

int main() {
    char v0;
    __int64 result;
    signed int i;
    char base[65] = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";

    for (i = 0; i <= 9; ++i)
    {
        v0 = base[i];
        base[i] = base[19 - i];
        result = 19 - i;
        base[result] = v0;
    }
    printf("%s\n", base);
    return 0;
}
// TSRQPONMLKJIHGFEDCBAUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
```

然后换表破解

```python
import base64

str_1 = "d2G0ZjLwHjS7DmOzZAY0X2lzX3CoZV9zdNOydO9vZl9yZXZlcnGlfD=="
str_base = "TSRQPONMLKJIHGFEDCBAUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"
str_zh_base = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"
flag = base64.b64decode(str_1.translate(str.maketrans(str_base,str_zh_base)))

print(flag)
# wctf2020{Base64_is_the_start_of_reverse}'
```

