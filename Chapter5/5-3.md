### 移位运算破解

![](https://pic1.imgdb.cn/item/67a5da3ed0e0a243d4fc9136.jpg)

如果 Dest 和 Str2 前 v5 个字节相同，则得到的是正确的 flag，而 v5 就是 Dest 的长度，也就是要 Dest = Str2

![](https://pic1.imgdb.cn/item/67a5da5ed0e0a243d4fc914b.jpg)

拿到 Str2 的字符

![](https://pic1.imgdb.cn/item/67a5da78d0e0a243d4fc9154.jpg)

再往上看，for 循环对 Dest 进行修改，第 j 位元素的 ASCII 加上 j，那么我们破解就循环减去 ，再往上看调用了 sub_4110BE 函数

![](https://pic1.imgdb.cn/item/67a5daa0d0e0a243d4fc9166.jpg)

又调用了一个函数，进去看看发现类似 Base64 编码

![](https://pic1.imgdb.cn/item/67a5dafad0e0a243d4fc9192.jpg)

双击 aA………… 看到常规的 Base64 编码表

![](https://pic1.imgdb.cn/item/67a5dc35d0e0a243d4fc91f9.jpg)

编写脚本破解

```python
import base64

str2 = 'e3nifIH9b_C@n@dH'

rawDest = ''

for i in range(len(str2)):
    rawDest += chr(ord(str2[i]) - i)

print(base64.b64decode(rawDest))
```

