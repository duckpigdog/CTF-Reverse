### UPX 脱壳

话不多说，直接上题（BugKu CTF）

![](https://pic1.imgdb.cn/item/67a5f753d0e0a243d4fc994a.jpg)

放入 Exeinfo PE 中发现有 upx 壳

![](https://pic1.imgdb.cn/item/67a5f766d0e0a243d4fc9961.jpg)

在 Kali 中使用 UPX 脱壳

![](https://pic1.imgdb.cn/item/67a5f78cd0e0a243d4fc9986.jpg)

在放入 Exeinfo PE 中发现没壳了

![](https://pic1.imgdb.cn/item/67a5f7b7d0e0a243d4fc99a8.jpg)

扔 IDA32 中反编译，首先是 v4 = "*F'\"N,\"(I?+@"

![](https://pic1.imgdb.cn/item/67a5f7ded0e0a243d4fc99bf.jpg)

拿到 _data_start__ 的值

![](https://pic1.imgdb.cn/item/67a5f7f7d0e0a243d4fc99cb.jpg)

在 _data_start__ 字符串里面寻找一个字符然后 -1 与 v4 进行对比

```python
v4 = [42,70,39,34,78,44,34,40,73,63,43,64]
s = ''
flag = ''
__data_strart__ = '~}|{zyxwvutsrqponmlkjihgfedcba`_^]\[ZYXWVUTSRQPONMLKJIHGFEDCBA@?>=<;:9876543210/.-,+*)(\'&%$# !"'

for i in v4:
    s += chr(__data_strart__.find(chr(i))+1)
    print(s)
```

