### IDA 断点读取内存

话不多说，直接上题（青少年 CTF 练习平台）

![](https://pic1.imgdb.cn/item/6813359e58cb8da5c8d60cac.png)

没壳

![](https://pic1.imgdb.cn/item/6813362f58cb8da5c8d60d10.png)

反编译伪代码可以发现 `a[]` 中存放的就是 flag

![](https://pic1.imgdb.cn/item/6813381a58cb8da5c8d60e07.png)

采取动态调试获取 flag，在最后 `return 0` 处打断点

![](https://pic1.imgdb.cn/item/6813399158cb8da5c8d60ef3.png)

右上角 Debugger --> Select Debugger，选择第三个

![](https://pic1.imgdb.cn/item/681338ce58cb8da5c8d60e68.png)

再按 F9 运行（菜单栏选择 **Debugger → Use source-level debugging**，确保此项被打钩）

![](https://pic1.imgdb.cn/item/6813396158cb8da5c8d60ee1.png)

先随便输入然后回车断住

![](https://pic1.imgdb.cn/item/68134b8458cb8da5c8d61b97.png)

F5 反编译后双击 `unk_403040` 可以看到字符串了

![](https://pic1.imgdb.cn/item/6813503058cb8da5c8d61e2f.png)

再写脚本

```python
a = [0x66,0x6D,0x63,0x64,0x7F,0x64,0x32,0x36,0x6A,0x6C,0x3E,0x3D,0x39,0x20,0x6F,0x3A,0x20,0x77,0x3F,0x27,0x25,0x27,0x22,0x3A,0x7A,0x2E,0x78,0x7A,0x31,0x2F,0x29,0x29,0x16,0x40,0x44,0x45,0x12,0x47,0x47,0x41,0x1A,0x54]
c = ''
b = 0
for i in a:
    c += chr(b ^ i)
    b += 1
print(c)
```

